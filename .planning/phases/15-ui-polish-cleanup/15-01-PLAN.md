---
phase: 15-ui-polish-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - web/src/components/Navigation.tsx
  - web/src/lib/formatters.ts
  - internal/models/models.go
autonomous: true

must_haves:
  truths:
    - "User sees visual indicator for current page in navigation"
    - "Active nav link has distinct styling from inactive links"
    - "No dead code remains in codebase (formatters.ts, Saving struct removed)"
  artifacts:
    - path: "web/src/components/Navigation.tsx"
      provides: "Navigation with active state detection"
      contains: "useLocation"
    - path: "internal/models/models.go"
      provides: "Clean models without orphaned Saving struct"
      excludes: "type Saving struct"
  key_links:
    - from: "Navigation.tsx"
      to: "react-router-dom"
      via: "useLocation hook"
      pattern: "useLocation.*pathname"
---

<objective>
Add navigation active states and remove orphaned code

Purpose: Improve UX with visual feedback on current page, clean up tech debt
Output: Navigation shows active page, dead code removed
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@web/src/components/Navigation.tsx
@internal/models/models.go
@web/src/lib/formatters.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add active state styling to Navigation</name>
  <files>web/src/components/Navigation.tsx</files>
  <action>
Update Navigation.tsx to show active state for current page:

1. Import `useLocation` from react-router-dom (add to existing import)
2. Convert Navigation to use the hook: `const { pathname } = useLocation()`
3. Create a NavLink helper component or inline logic to apply active styles:
   - Active state: `bg-blue-500/30 text-blue-400` (or `bg-purple-500/30 text-purple-400` for Accounts)
   - Keep existing hover states for inactive links
4. Match paths:
   - "/" → Dashboard (exact match)
   - "/cloud-accounts" → Accounts
   - "/instances" → Instances (also matches /instances/:id)
   - "/schedules" → Schedules
   - "/recommendations" → Recommendations
   - "/audit-log" → Audit Log

Pattern to follow:
```tsx
const isActive = (path: string) => 
  path === '/' ? pathname === '/' : pathname.startsWith(path)

// Then for each Link:
className={`... ${isActive('/') ? 'bg-blue-500/30 text-blue-400' : 'text-slate-300'}`}
```

Keep existing structure and styling patterns. Only add active state logic.
  </action>
  <verify>
Run `cd web && npm run build` - no TypeScript errors.
Visual check: Navigate to different pages, active link should have distinct styling.
  </verify>
  <done>
Active navigation link has background highlight (blue-500/30) and colored text (blue-400).
Inactive links remain slate-300 with hover effects.
  </done>
</task>

<task type="auto">
  <name>Task 2: Remove orphaned formatters.ts</name>
  <files>web/src/lib/formatters.ts</files>
  <action>
Delete the orphaned file `web/src/lib/formatters.ts`.

This file contains formatCurrency() and formatHours() functions that were used for the savings feature (removed in Phase 9). No imports exist for this file.

Command: `rm web/src/lib/formatters.ts`

Verify no imports exist first:
`grep -r "formatters" web/src --include="*.ts" --include="*.tsx"`
  </action>
  <verify>
`ls web/src/lib/formatters.ts` returns "No such file"
`grep -r "formatters" web/src` returns no results
`cd web && npm run build` passes
  </verify>
  <done>
formatters.ts file deleted, build passes, no broken imports.
  </done>
</task>

<task type="auto">
  <name>Task 3: Remove orphaned Saving struct from models.go</name>
  <files>internal/models/models.go</files>
  <action>
Remove the orphaned Saving struct from internal/models/models.go (lines 116-123):

```go
// Saving represents aggregated savings data
type Saving struct {
	ID                    string `json:"id" db:"id"`
	InstanceID            string `json:"instance_id" db:"instance_id"`
	Date                  string `json:"date" db:"date"`
	StoppedMinutes        int    `json:"stopped_minutes" db:"stopped_minutes"`
	EstimatedSavingsCents int    `json:"estimated_savings_cents" db:"estimated_savings_cents"`
}
```

This struct was used for savings tracking (removed in Phase 9). No code references `models.Saving` anymore.

Verify no usages before deletion:
`grep -r "models\.Saving" internal/ --include="*.go"`
  </action>
  <verify>
`grep "type Saving struct" internal/models/models.go` returns no results
`grep -r "models\.Saving" internal/` returns no results
`go build ./...` passes
  </verify>
  <done>
Saving struct removed from models.go, Go build passes, no broken references.
  </done>
</task>

</tasks>

<verification>
1. `cd web && npm run build` - TypeScript compiles without errors
2. `go build ./...` - Go compiles without errors
3. Navigation shows active state when browsing different pages
4. `grep -r "formatters" web/src` - returns nothing
5. `grep "type Saving" internal/models/` - returns nothing
</verification>

<success_criteria>
- Navigation active states work (visual distinction for current page)
- formatters.ts deleted
- Saving struct removed from models.go
- Both frontend and backend build successfully
</success_criteria>

<output>
After completion, create `.planning/phases/15-ui-polish-cleanup/15-01-SUMMARY.md`
</output>
