---
phase: 06-intelligent-recommendations
plan: 04
type: execute
wave: 3
depends_on: ["06-03"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "System analyzes activity metrics and generates potential sleep schedule recommendations"
    - "Recommendations display as cards on the main dashboard"
    - "Recommendations are available in a dedicated recommendations tab"
    - "Each recommendation shows suggested sleep/wake times based on activity patterns"
    - "User can review a recommendation and confirm to create a schedule"
  artifacts: []
  key_links: []
---

<objective>
Verify end-to-end recommendation workflow functions correctly.

Purpose: Human verification that all requirements are met and the recommendation system works as designed.

Output: Phase 6 verification complete, ready for production.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-intelligent-recommendations/06-CONTEXT.md

# Summaries from prior plans
@.planning/phases/06-intelligent-recommendations/06-01-SUMMARY.md
@.planning/phases/06-intelligent-recommendations/06-02-SUMMARY.md
@.planning/phases/06-intelligent-recommendations/06-03-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete recommendation system with:
- Backend: Recommendation generation from idle patterns, API endpoints for list/generate/dismiss/confirm
- Frontend: RecommendationCard with collapsible details, RecommendationModal with activity graph, ActivityGraph visualization
- Integration: Dashboard recommendations section with generate button, RecommendationsPage with full functionality
  </what-built>
  <how-to-verify>
**Setup:**
1. Start backend: `go run cmd/server/main.go`
2. Start frontend: `cd web && npm run dev`
3. Open http://localhost:5173

**Test 1: Dashboard Recommendations Section**
1. Navigate to Dashboard
2. Verify "AI Recommendations" section exists
3. Verify "Generate" button is visible
4. Click "Generate" button - should show loading spinner
5. Verify toast notification appears (even if 0 recommendations generated)

**Test 2: Empty State Display**
1. If no recommendations exist, verify empty state shows:
   - "Need 24+ hours of activity data to generate recommendations" message
   - Or count of dismissed recommendations if any were dismissed
2. Verify "Generate Recommendations" button is visible in empty state

**Test 3: Recommendations Page**
1. Navigate to /recommendations
2. Verify header shows pending/dismissed counts
3. Verify "Generate Recommendations" button exists
4. Click generate button - verify it works same as dashboard

**Test 4: Recommendation Card Display (if recommendations exist)**
Note: This requires having instances with 24+ hours of metric data. If no real data:
1. Insert test recommendation directly in database
2. Verify card shows:
   - "AI Suggested" purple badge
   - Instance name
   - Confidence label (High/Medium/Low, NOT percentage per CONTEXT.md)
   - Estimated savings in $/day
   - Expand/collapse chevron
3. Click card to expand - verify details section appears
4. Verify "View Details" and "Mark as Not Now" buttons

**Test 5: Recommendation Modal (if recommendations exist)**
1. Click "View Details" on a recommendation card
2. Verify modal opens with:
   - "Confirm Schedule Recommendation" title
   - AI Suggested badge + instance name
   - Activity graph (24-hour visualization)
   - Suggested sleep/wake times in human-readable format
   - Estimated savings summary (green highlight)
   - Confidence label
3. Click "Cancel" - modal should close
4. Click "View Details" again, then click "Create Schedule"
5. Verify:
   - Loading state on button
   - Success toast
   - Modal closes
   - Recommendation removed from list

**Test 6: Dismiss Flow (if recommendations exist)**
1. Click "Mark as Not Now" on a recommendation
2. Verify toast notification
3. Verify recommendation removed from list
4. Verify dismissed count increases

**Test 7: Created Schedule Verification**
1. Navigate to /schedules
2. Find schedule created from recommendation
3. Verify name is "AI Suggested: {instance_name}"
4. Verify CRON schedules match what was shown in modal
5. Verify schedule is enabled
  </how-to-verify>
  <resume-signal>
Type "approved" if all tests pass.

If issues found, describe:
- Which test failed
- Expected vs actual behavior
- Any error messages in console
  </resume-signal>
</task>

</tasks>

<verification>
Human verification of complete recommendation flow from generation through schedule creation.
</verification>

<success_criteria>
All phase requirements verified:
- REC-01: System analyzes activity metrics and recommends potential sleep schedules ✓
- REC-02: Recommendations display as cards on the main dashboard ✓
- REC-03: Recommendations available in a dedicated recommendations tab ✓
- REC-04: Recommendation shows suggested sleep/wake times based on activity patterns ✓
- REC-05: User can review recommendation and confirm to create schedule ✓
- REC-06: Confirmed recommendations create new schedule entry ✓
</success_criteria>

<output>
After approval, create `.planning/phases/06-intelligent-recommendations/06-04-SUMMARY.md` and update STATE.md to mark Phase 6 complete.
</output>
